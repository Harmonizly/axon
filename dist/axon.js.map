{"version":3,"sources":["webpack://axon/webpack/bootstrap","webpack://axon/./src/api/v1/handlers/health.js","webpack://axon/./src/api/v1/routes/index.js","webpack://axon/./src/error/codes.js","webpack://axon/./src/error/index.js","webpack://axon/./src/error/utils.js","webpack://axon/./src/main.js","webpack://axon/./src/middleware/accessLogger.js","webpack://axon/./src/middleware/error.js","webpack://axon/./src/middleware/transaction.js","webpack://axon/./src/router.js","webpack://axon/./src/server.js","webpack://axon/./src/utils/graphql.js","webpack://axon/./src/utils/logger.js","webpack://axon/./src/utils/sigInitHandler.js","webpack://axon/./src/utils/uncaughtExceptionHandler.js","webpack://axon/./src/utils/unhandledRejectionHandler.js","webpack://axon/external \"apollo-cache-inmemory\"","webpack://axon/external \"apollo-client\"","webpack://axon/external \"apollo-link\"","webpack://axon/external \"apollo-link-error\"","webpack://axon/external \"apollo-link-http\"","webpack://axon/external \"bunyan\"","webpack://axon/external \"config\"","webpack://axon/external \"domain\"","webpack://axon/external \"events\"","webpack://axon/external \"fs\"","webpack://axon/external \"https\"","webpack://axon/external \"koa\"","webpack://axon/external \"koa-body\"","webpack://axon/external \"koa-compress\"","webpack://axon/external \"koa-cors\"","webpack://axon/external \"koa-helmet\"","webpack://axon/external \"koa-morgan\"","webpack://axon/external \"koa-mount\"","webpack://axon/external \"koa-router\"","webpack://axon/external \"koa-static\"","webpack://axon/external \"node-fetch\"","webpack://axon/external \"process\"","webpack://axon/external \"uuid/v4\""],"names":["ctx","status","body","health","router","get","DEFAULT_FATAL_ERROR","FATAL_ERROR","message","code","category","DEFAULT_GENERAL_ERROR","GENERAL_ERROR","DEFAULT_NETWORK_ERROR","NETWORK_ERROR","NOT_YET_IMPLEMENTED","ILLEGAL_STATE_EXCEPTION","DEFAULT_INVALID_REQUEST","INVALID_REQUEST","DEFAULT_UNAUTHORIZED","UNAUTHORIZED","DEFAULT_FORBIDDEN","FORBIDDEN","MISSING_REQUIRED_PARAMETER","DEFAULT_SERVICE_UNAVAILABLE","SERVICE_UNAVAILABLE","DEFAULT_VALIDATION_ERROR","VALIDATION_ERROR","codes","ApiError","payload","e","error","Error","captureStackTrace","constructor","stack","AuthorizationError","NOT_ALLOWED","GraphQLError","InternalError","InvalidRequestError","NetworkError","ServiceUnavailableError","convertSystemFetchErrorStatus","resolveCode","resolveError","resolveMessage","resolveStatus","DEFAULT_CODE","DEFAULT_MESSAGE","DEFAULT_STATUS","type","errno","typeStatus","GraphQLClient","Logger","LOGGER","getLogger","formatter","tokens","req","res","responseTime","JSON","stringify","date","method","url","HTTP","referrer","stream","write","info","parse","next","err","app","emit","transactionId","transaction","create","add","data","id","Promise","resolve","reject","run","use","routes","process","on","Server","config","appRouter","destroy","logger","initialize","initializeRouter","createServer","server","secure","createHttpsServer","all","cb","request","response","redirect","hostname","port","sslConfig","ssl","httpsConfig","Object","assign","key","readFileSync","cert","callback","getListenCallback","send","initializeMiddleware","baseRouter","allowedMethods","start","listen","stop","uri","cache","connectToDevTools","link","defaultLink","defaultErrorHandler","graphQLErrors","errors","graphQLError","map","networkError","opts","from","fetch","DEFAULT_LOGGER_NAME","_emit","rec","noemit","r","serializeTransaction","domain","session","sessionId","user","username","name","handlersConfig","loggers","handlers","loggerName","toLowerCase","sigInitHandler","exit","uncaughtExceptionHandler","unhandledRejectionHandler"],"mappings":"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I,CAAlC,EAAkD;AAC/D,MAAI0B,MAAJ,EAAY;AACVA,WAAOzB,KAAP,CAAa,uDAAb;AACAyB,WAAOzB,KAAP,CAAaD,CAAb;AACD;;AAED4D,UAAQqE,IAAR,CAAa,CAAb;AACD,C;;;;;;;;;;;;;;;;kBCPuBE,yB;;AATxB;;;;;;AAEA,IAAMzG,SAAiB,iBAAOC,SAAP,CAAiB,OAAjB,CAAvB;;AAEA;;;;;AAKe,SAASwG,yBAAT,CAAmCnI,CAAnC,EAAmD;AAChE,MAAI0B,MAAJ,EAAY;AACVA,WAAOzB,KAAP,+CAAyDD,CAAzD;AACD;AACF,C;;;;;;;;;;;;;;;;;;;;;;;;;ACbD,kD;;;;;;;;;;;;ACAA,0C;;;;;;;;;;;;ACAA,wC;;;;;;;;;;;;ACAA,8C;;;;;;;;;;;;ACAA,6C;;;;;;;;;;;;ACAA,mC;;;;;;;;;;;;ACAA,mC;;;;;;;;;;;;ACAA,mC;;;;;;;;;;;;ACAA,mC;;;;;;;;;;;;ACAA,+B;;;;;;;;;;;;ACAA,kC;;;;;;;;;;;;ACAA,gC;;;;;;;;;;;;ACAA,qC;;;;;;;;;;;;ACAA,yC;;;;;;;;;;;;ACAA,qC;;;;;;;;;;;;ACAA,uC;;;;;;;;;;;;ACAA,uC;;;;;;;;;;;;ACAA,sC;;;;;;;;;;;;ACAA,uC;;;;;;;;;;;;ACAA,uC;;;;;;;;;;;;ACAA,uC;;;;;;;;;;;;ACAA,oC;;;;;;;;;;;;ACAA,oC","file":"axon.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssembly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * [ping description]\n * @param  {[type]} ctx  [description]\n * @return {[type]}      [description]\n */\nexport default async function health(ctx: Object): void {\n  ctx.status = 200;\n  ctx.body = 'ok';\n}\n","import Router from 'koa-router';\n\nimport health from 'axon/api/v1/handlers/health';\n\nconst router = new Router();\n\nrouter.get('/health', health);\n\nexport default router;\n","/**\n * [DEFAULT_FATAL_ERROR description]\n * @type {[type]}\n */\nexport const DEFAULT_FATAL_ERROR: String =\n  'An error occurred. If this error persists, please contact your System Administrator';\n\n/**\n * [FATAL_ERROR description]\n * @type {[type]}\n */\nexport const FATAL_ERROR: Function = (message: String = DEFAULT_FATAL_ERROR): Object => {\n  return {\n    status: 500,\n    code: -1,\n    category: 'IllegalStateException',\n    message,\n  };\n};\n\n/**\n * [DEFAULT_GENERAL_ERROR description]\n * @type {[type]}\n */\nexport const DEFAULT_GENERAL_ERROR: String = \"Our hamsters don't know how to handle that request\";\n\n/**\n * [GENERAL_ERROR description]\n * @type {[type]}\n */\nexport const GENERAL_ERROR: Function = (message: String = DEFAULT_GENERAL_ERROR): Object => {\n  return {\n    status: 400,\n    code: '0a',\n    category: 'GeneralException',\n    message,\n  };\n};\n\n/**\n * [DEFAULT_NETWORK_ERROR description]\n * @type {[type]}\n */\nexport const DEFAULT_NETWORK_ERROR: String = 'The network request failed';\n\n/**\n * [NETWORK_ERROR description]\n * @type {[type]}\n */\nexport const NETWORK_ERROR: Function = (message: String = DEFAULT_NETWORK_ERROR, status: Number = 500): Object => {\n  return {\n    status,\n    code: '0b',\n    category: 'NetworkException',\n    message,\n  };\n};\n\n/**\n * [NOT_YET_IMPLEMENTED description]\n * @type {[type]}\n */\nexport const NOT_YET_IMPLEMENTED: Function = (): Object => {\n  return {\n    status: 501,\n    code: 1,\n    category: 'NotYetImplemented',\n    message: 'This method must be implmented',\n  };\n};\n\n/**\n * [ILLEGAL_STATE_EXCEPTION description]\n * @type {[type]}\n */\nexport const ILLEGAL_STATE_EXCEPTION: Function = (): Object => {\n  return {\n    status: 500,\n    code: 2,\n    category: 'IllegalStateException',\n    message: 'Application not configured correctly',\n  };\n};\n\n/**\n * [DEFAULT_INVALID_REQUEST description]\n * @type {[type]}\n */\nexport const DEFAULT_INVALID_REQUEST: String = \"Our hamsters don't know how to handle that request\";\n\n/**\n * [INVALID_REQUEST description]\n * @type {[type]}\n */\nexport const INVALID_REQUEST: Function = (message: String = DEFAULT_INVALID_REQUEST): Object => {\n  return {\n    status: 400,\n    code: 100,\n    category: 'UserError',\n    message,\n  };\n};\n\n/**\n * [DEFAULT_UNAUTHORIZED description]\n * @type {[type]}\n */\nconst DEFAULT_UNAUTHORIZED: String = 'Your session is no longer valid. Please login and rety';\n\n/**\n * [UNAUTHORIZED description]\n * @type {[type]}\n */\nexport const UNAUTHORIZED: Function = (message: String = DEFAULT_UNAUTHORIZED): Object => {\n  return {\n    status: 401,\n    code: 4,\n    category: 'SecurityException',\n    message,\n  };\n};\n\n/**\n * [DEFAULT_FORBIDDEN description]\n * @type {[type]}\n */\nexport const DEFAULT_FORBIDDEN: String = 'You are not allowed to access that resource';\n\n/**\n * [FORBIDDEN description]\n * @type {[type]}\n */\nexport const FORBIDDEN: Function = (message: String = DEFAULT_FORBIDDEN): Object => {\n  return {\n    status: 403,\n    code: 5,\n    category: 'SecurityException',\n    message,\n  };\n};\n\n/**\n * [MISSING_REQUIRED_PARAMETER description]\n * @type {[type]}\n */\nexport const MISSING_REQUIRED_PARAMETER: Function = (): Object => {\n  return {\n    status: 400,\n    code: 6,\n    category: 'GeneralException',\n    message: 'A required parameter was missing',\n  };\n};\n\n/**\n * [DEFAULT_SERVICE_UNAVAILABLE description]\n * @type {[type]}\n */\nexport const DEFAULT_SERVICE_UNAVAILABLE: String = 'Our hamsters appear to be taking a siesta';\n\n/**\n * [SERVICE_UNAVAILABLE description]\n * @type {[type]}\n */\nexport const SERVICE_UNAVAILABLE: Function = (message: String = DEFAULT_SERVICE_UNAVAILABLE): Object => {\n  return {\n    status: 503,\n    code: 7,\n    category: 'NetworkException',\n    message,\n  };\n};\n\n/**\n * [DEFAULT_VALIDATION_ERROR description]\n * @type {[type]}\n */\nexport const DEFAULT_VALIDATION_ERROR: String = 'Hmmm...the hamsters found a problem with that data';\n\n/**\n * [VALIDATION_ERROR description]\n * @type {[type]}\n */\nexport const VALIDATION_ERROR: Function = (message: String = DEFAULT_VALIDATION_ERROR): Object => {\n  return {\n    status: 400,\n    code: 200,\n    category: 'ValidationException',\n    message,\n  };\n};\n","import {\n  convertSystemFetchErrorStatus,\n  resolveCode,\n  resolveError,\n  resolveMessage,\n  resolveStatus,\n} from 'axon/error/utils';\nimport * as codes from 'axon/error/codes';\n\n/**\n * [code description]\n * @type {[type]}\n */\nexport default class ApiError extends Error {\n  code: number;\n  error: Object;\n  status: number;\n\n  /**\n   * [constructor description]\n   * @param  {[type]} payload [description]\n   * @param  {[type]} code    [description]\n   * @param  {[type]} status  [description]\n   * @param  {[type]} e       [description]\n   * @return {[type]}         [description]\n   */\n  constructor(payload: string | Object, status, e: Error) {\n    super(resolveMessage(payload));\n    this.code = resolveCode(payload);\n    this.status = resolveStatus(payload, status);\n    this.error = resolveError(e || status);\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      this.stack = (new Error(this.message)).stack;\n    }\n  }\n}\n\n/**\n * [error description]\n * @type {[type]}\n */\nexport class AuthorizationError extends ApiError {\n  /**\n   * [constructor description]\n   * @param {[type]} errors [description]\n   */\n  constructor(e: ?Error) {\n    super(codes.NOT_ALLOWED, e);\n  }\n}\n\n/**\n * [errors description]\n * @type {[type]}\n */\nexport class GraphQLError extends ApiError {\n  /**\n   * [constructor description]\n   * @param {[type]} errors [description]\n   */\n  constructor(e: ?Error) {\n    super(codes.GENERAL_ERROR(e.message), e);\n  }\n}\n\n/**\n * [message description]\n * @type {[type]}\n */\nexport class InternalError extends ApiError {\n  constructor(message: String, e: ?Error) {\n    super(codes.FATAL_ERROR(message), e);\n  }\n}\n\n/**\n * [message description]\n * @type {[type]}\n */\nexport class InvalidRequestError extends ApiError {\n  /**\n   * [constructor description]\n   * @param {[type]} errors [description]\n   */\n  constructor(message: String, e: ?Error) {\n    super(codes.INVALID_REQUEST(message), e);\n  }\n}\n\n/**\n * [error description]\n * @type {[type]}\n */\nexport class NetworkError extends ApiError {\n  /**\n   * [constructor description]\n   * @param {[type]} error [description]\n   */\n  constructor(e: ?FetchError) {\n    super(codes.NETWORK_ERROR(convertSystemFetchErrorStatus(e)), e);\n  }\n}\n\n/**\n *\n */\nexport class ServiceUnavailableError extends ApiError {\n  /**\n   * [constructor description]\n   * @param {[type]} errors [description]\n   */\n  constructor(message: String, e: ?Error) {\n    super(codes.SERVICE_UNAVAILABLE(message), e);\n  }\n}\n\nexport { codes };\n","const DEFAULT_CODE: number = 0;\nconst DEFAULT_MESSAGE: string = 'An Unknown error occurred';\nconst DEFAULT_STATUS: number = 500;\n\n/**\n * [error description]\n * @type {[type]}\n */\nexport function convertSystemFetchErrorStatus(error: FetchError): Number {\n  if (error.type === 'system') {\n    switch (error.errno) {\n      case 'ENOTFOUND':\n        return 503;\n      case 'ECONNRESET':\n        return 503;\n      case 'ECONNREFUSED':\n        return 503;\n      default:\n        return 500;\n    }\n  }\n\n  switch (error.type) {\n    case 'body-timeout':\n      return 503;\n    case 'invalid-json':\n      return 400;\n    case 'max-redirect':\n      return 503;\n    case 'max-size':\n      return 400;\n    case 'no-redirect':\n      return 503;\n    case 'request-timeout':\n      return 503;\n    default:\n      return 500;\n  }\n}\n\n/**\n * [resolveCode description]\n * @param  {[type]} payload [description]\n * @return {[type]}         [description]\n */\nexport function resolveCode(payload: number | Object): number {\n  if (typeof payload === 'number') {\n    return ('code' in payload) ? DEFAULT_CODE : payload.code;\n  }\n\n  return DEFAULT_CODE;\n}\n\n/**\n * [resolveError description]\n * @param  {[type]} e [description]\n * @return {[type]}   [description]\n */\nexport function resolveError(e: Error): Object {\n  return { ...e };\n}\n\n/**\n * [resolveMessage description]\n * @param  {[type]} payload [description]\n * @return {[type]}         [description]\n */\nexport function resolveMessage(payload: string | Object): string {\n  if (typeof payload === 'object') {\n    return ('message' in payload) ? DEFAULT_MESSAGE : payload.message;\n  }\n\n  return payload;\n}\n\n/**\n * [resolveStatus description]\n * @param  {[type]} payload [description]\n * @param  {[type]} status  [description]\n * @return {[type]}         [description]\n */\nexport function resolveStatus(payload: number | Object, status: ?number): number {\n  if (typeof payload === 'object' && 'status' in payload) {\n    return payload.status;\n  }\n\n  const typeStatus: String = typeof (status);\n\n  return (typeStatus !== 'number' || typeStatus !== 'string') ? DEFAULT_STATUS : status;\n}\n","/**\n * Export file for Axon \n */\n\nimport ApiError, {\n  AuthorizationError,\n  GraphQLError,\n  InternalError,\n  InvalidRequestError,\n  NetworkError,\n  ServiceUnavailableError,\n} from 'axon/error';\nimport GraphQLClient from 'axon/utils/graphql';\nimport Logger from 'axon/utils/logger';\nimport Server from 'axon/server';\n\nimport * as codes from 'axon/error/codes';\n\nexport default Server;\nexport {\n  ApiError,\n  AuthorizationError,\n  codes,\n  GraphQLClient,\n  GraphQLError,\n  InternalError,\n  InvalidRequestError,\n  Logger,\n  NetworkError,\n  ServiceUnavailableError,\n};\n","import morgan from 'koa-morgan';\n\nimport Logger from 'axon/utils/logger';\n\nconst LOGGER: Object = Logger.getLogger('access');\n\n/**\n * Morgan log formatter.\n * Returns an object containing the desired request and response attributes.\n * The expected output should be a JSON string as <code>bunyan</code> will\n * take the string and merge that JSON with the output (which is the desired\n * result). The expected format is:\n * {\n *   remote-addr: <string>,\n *   date: <clf>,\n *   method: <string>,\n *   url: <fqd string>,\n *   HTTP: <version string>,\n *   user-agent: <string>,\n *   referrer: <string>,\n *   status: <number>,\n *   res[content-length]: <number>,\n *   response-time: <number> ms,\n * }\n * @param  {Object} tokens The map of morgan tokens\n * @param  {Object} req    The request context\n * @param  {Object} res    The response context\n * @return {Object}        The format meta object\n */\nexport const formatter = function (tokens, req, res) {\n  const responseTime = tokens['response-time'](req, res);\n\n  return JSON.stringify({\n    'remote-addr': tokens['remote-addr'](req),\n    date: tokens.date(req, res, 'clf'),\n    method: tokens.method(req),\n    url: tokens.url(req),\n    HTTP: tokens['http-version'](req),\n    'user-agent': tokens['user-agent'](req),\n    referrer: tokens.referrer(req),\n    status: tokens.status(req, res),\n    'res[content-length]': tokens.res(req, res, 'content-length'),\n    'response-time': `${responseTime} ms`,\n  });\n};\n\nexport default morgan(formatter, {\n  stream: {\n    write(message) {\n      LOGGER.info(JSON.parse(message));\n    },\n  },\n});\n","import ApiError, { InternalError } from 'axon/error';\nimport Logger from 'axon/utils/logger';\n\nconst LOGGER: Object = Logger.getLogger('root');\n\n/**\n * [errorMiddleware description]\n * @param  {[type]}   ctx  [description]\n * @param  {Function} next [description]\n * @return {[type]}        [description]\n */\nexport default async (ctx: Object, next: Function): void => {\n  try {\n    await next();\n  } catch (e) {\n    let err = e;\n\n    if (!(e instanceof ApiError)) {\n      err = (ctx.status === 500) ? new InternalError(e.message, e) : new ApiError(e.message, e);\n    }\n\n    LOGGER.error(err, ctx);\n    ctx.status = err.status;\n    ctx.body = err;\n\n    ctx.app.emit('error', err, ctx);\n  }\n};\n","import domain from 'domain';\nimport uuidv4 from 'uuid/v4';\n\n/**\n * Add a transaction identifier to every request to track a request's control flow. We use a transactoin ID instead of\n * the session ID or user since both are persistent(ish) identification.\n *\n * @param  {[type]}   ctx   [description]\n * @param  {Function} next  [description]\n * @return {[type]}         [description]\n */\nexport default (ctx: Object, next: Function): void => {\n  const transactionId: string = uuidv4();\n  const transaction: Object = domain.create();\n\n  // eslint-disable-next-line no-param-reassign\n  ctx.transactionId = transactionId;\n\n  transaction.add(ctx);\n  transaction.data = {\n    id: transactionId,\n    ctx,\n  };\n\n  return new Promise((resolve, reject) => {\n    transaction.run(async () => {\n      try {\n        await next();\n        return resolve();\n      } catch (e) {\n        return reject(e);\n      }\n    });\n  });\n};\n","import Router from 'koa-router';\n\nimport v1 from 'axon/api/v1/routes';\n\nconst router = new Router();\n\nrouter.use(v1.routes());\n\nexport default router;\n","import body from 'koa-body';\nimport compress from 'koa-compress';\nimport cors from 'koa-cors';\nimport EventEmitter from 'events';\nimport fs from 'fs';\nimport helmet from 'koa-helmet';\nimport https from 'https';\nimport Koa from 'koa';\nimport mount from 'koa-mount';\nimport serve from 'koa-static';\n\nimport accessLogger from 'axon/middleware/accessLogger';\nimport errorMiddleware from 'axon/middleware/error';\nimport Logger from 'axon/utils/logger';\nimport router from 'axon/router';\nimport sigInitHandler from 'axon/utils/sigInitHandler';\nimport transactionMiddleware from 'axon/middleware/transaction';\nimport uncaughtExceptionHandler from 'axon/utils/uncaughtExceptionHandler';\nimport unhandledRejectionHandler from 'axon/utils/unhandledRejectionHandler';\n\n// Catches ctrl+c event\nprocess.on('SIGINT', sigInitHandler);\n\n// Catches uncaught exceptions and rejections\nprocess.on('uncaughtException', uncaughtExceptionHandler);\nprocess.on('unhandledRejection', unhandledRejectionHandler);\n\n/**\n * [app description]\n * @type {[type]}\n */\nexport default class Server extends EventEmitter {\n  app: Function;\n  config: Object;\n  logger: Object;\n  router: Object;\n\n  /**\n   * [constructor description]\n   * @constructor\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  constructor(config: Object, appRouter: Object): void {\n    super();\n\n    // atexit handler\n    process.on('exit', this.destroy);\n\n    this.config = config;\n\n    // Initialize the express server\n    this.app = new Koa();\n\n    // Create the logger\n    this.logger = Logger.getLogger('app');\n\n    // Configure the app with common middleware\n    this.initialize(this.app);\n\n    this.initializeRouter(router, appRouter);\n\n    this.emit('ready');\n  }\n\n  /**\n   * [createServer description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  createServer(): Object {\n    return (this.config.server.secure) ? this.createHttpsServer() : this.app;\n  }\n\n  /**\n   * [startHttps description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  createHttpsServer(): void {\n    this.app.all('*', function cb(request: Object, response: Object, next: Function) {\n      if (request.secure) {\n        return next();\n      }\n\n      return response.redirect(`https://${request.hostname}:${this.config.server.port}${request.url}`);\n    });\n\n    const sslConfig = this.config.server.ssl;\n    const httpsConfig = Object.assign({}, sslConfig, {\n      key: fs.readFileSync(sslConfig.get('key')),\n      cert: fs.readFileSync(sslConfig.get('cert')),\n    });\n\n    return https.createServer(httpsConfig, this.app.callback());\n  }\n\n  /**\n   * [callback description]\n   * @type {Function}\n   */\n  getListenCallback(callback: Function): Function {\n    return () => {\n      if (callback != null) {\n        callback();\n      }\n\n      this.emit('start');\n\n      if (process.send) {\n        process.send('ready');\n      }\n\n      this.logger.info(`Server listening at ${this.config.server.hostname}:${this.config.server.port}...`);\n    };\n  }\n\n  /**\n   * [app description]\n   * @type {[type]}\n   */\n  initialize(app: Object): void {\n    // Add common request security measures\n    app.use(helmet());\n\n    // Enabled CORS (corss-origin resource sharing)\n    app.use(cors(this.config.get('cors')));\n\n    // request compression\n    app.use(compress(this.config.get('compress')));\n\n    // Initialize body parser before routes or body will be undefined\n    app.use(body(this.config.get('body')));\n\n    // Trace a single request process (including over async)\n    app.use(transactionMiddleware);\n\n    // Configure Request logging\n    app.use(accessLogger);\n\n    this.initializeMiddleware();\n\n    // Configure the request error handling\n    app.use(errorMiddleware);\n  }\n\n  /**\n   * [initializeMiddleware description]\n   * @return {[type]} [description]\n   */\n  initializeMiddleware() {\n    // Override to provide custom middleware\n  }\n\n  /**\n   * [initializeRouter description]\n   * @param  {[type]} appRouter [description]\n   * @return {[type]}           [description]\n   */\n  initializeRouter(baseRouter: Object, appRouter: Object): void {\n    // Combine with application-specific router\n    baseRouter.use(appRouter.routes());\n\n    this.app.use(baseRouter.routes());\n    this.app.use(baseRouter.allowedMethods());\n  }\n\n  /**\n   * [destroy description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  destroy(): void {\n    // TODO logger destroy?\n    this.emit('destroy');\n    process.emit('destroy');\n  }\n\n  /**\n   * [callback description]\n   * @type {Function}\n   */\n  async start(callback: Function | null = null): void {\n    if (!this.app) {\n      throw new Error('Cannot start server: the express instance is not defined');\n    }\n\n    try {\n      this.emit('before:start');\n      return this.createServer().listen(\n        this.config.get('port'),\n        this.config.get('hostname'),\n        this.config.get('backlog'),\n        this.getListenCallback(callback),\n      );\n      this.emi('after:start');\n    } catch (e) {\n      this.logger.error(e);\n      this.destroy();\n      throw e;\n    }\n  }\n\n  /**\n   * [stop description]\n   * @param  {Function} callback [description]\n   * @return {[type]}            [description]\n   */\n  stop(callback: Function | null = null): void {\n    this.logger.info(`Server (${this.config.hostname}:${this.config.port}) stopping...`);\n\n    this.emit('before:stop');\n    if (callback) {\n      callback();\n    }\n\n    this.destroy();\n    this.emit('after:stop');\n  }\n}\n","import { GraphQLException, NetworkException } from 'axon/error';\n\nimport fetch from 'node-fetch';\nimport { ApolloClient } from 'apollo-client';\nimport { ApolloLink } from 'apollo-link';\nimport { HttpLink } from 'apollo-link-http';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport { onError } from 'apollo-link-error';\n\ntype APOLLO_LINK_ERROR = {\n  operation: Object,\n  response: Object,\n  graphQLErrors: Array<Object>,\n  networkError: ?Error,\n}\n\n/**\n * [description]\n * @return {[type]} [description]\n */\nfunction defaultErrorHandler(error: APOLLO_LINK_ERROR) {\n  if (error.graphQLErrors) {\n    // eslint-disable-next-line no-param-reassign\n    error.response.errors = error.graphQLError.map((err: Object) => {\n      return new GraphQLException(err);\n    });\n  }\n\n  if (error.networkError) {\n    // eslint-disable-next-line no-param-reassign\n    error.networkError = new NetworkException(error.networkError);\n  }\n}\n\n/**\n * [DefaultLink description]\n * @param       {[type]} opts [description]\n * @constructor\n */\nfunction defaultLink(opts: Object): Function<ApolloLink> {\n  return ApolloLink.from([\n    // eslint-disable-next-line new-cap\n    new onError(defaultErrorHandler),\n    new HttpLink({ uri: opts.uri, fetch }),\n  ]);\n}\n\n/**\n * [description]\n * @param  {[type]} uri  [description]\n * @return {[type]}      [description]\n */\nexport default function (uri: String): ApolloClient {\n  return new ApolloClient({\n    cache: new InMemoryCache(),\n    connectToDevTools: (process.env.NODE_ENV === 'development'),\n    link: defaultLink({ uri }),\n  });\n}\n","import Bunyan from 'bunyan';\nimport config from 'config';\nimport process from 'process';\n\nconst DEFAULT_LOGGER_NAME: string = 'root';\n\n/*\n * BEGIN NOTE: example of stream config\n  streamConfig = Object.assign({}, streamsConfig.get('cloudwatch'));\n  streamConfig.logStreamName += `-${process.pid}-${uuidv4()}`;\n  logger.addStream({\n    name: 'cloudwatch',\n    type: 'raw',\n    stream: createCWStream(Object.assign({}, streamConfig)),\n  });\n * END NOTE\n */\n\n/**\n *\n */\nclass Logger extends Bunyan {\n  // loggers cache\n  static loggers: Object = {};\n\n  /**\n   * [debug description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  _emit(rec, noemit) {\n    const r: Object = this.serializeTransaction(rec);\n\n    // eslint-disable-next-line no-underscore-dangle\n    return super._emit(r, noemit);\n  }\n\n  /**\n   * [formatTransaction description]\n   * @param  {[type]} Object [description]\n   * @return {[type]}        [description]\n   */\n  serializeTransaction(rec: Object): Object {\n    const r: Object = rec;\n    const transaction: Object = process.domain;\n\n    if (transaction && transaction.data) {\n      const { ctx } = transaction.data;\n\n      r.transactionId = transaction.data.id;\n      if (ctx.session) {\n        r.sessionId = ctx.session.id;\n      }\n\n      if (ctx.user) {\n        r.user = {\n          id: ctx.user.id,\n          username: ctx.user.username,\n        };\n      }\n    }\n\n    return rec;\n  }\n\n  /**\n   * [getLogger description]\n   * @param  {[type]} name [description]\n   * @return {[type]}      [description]\n   */\n  static getLogger(name: string): Object {\n    const handlersConfig: Object = config.loggers.handlers;\n    const loggerName: string = (name == null) ? DEFAULT_LOGGER_NAME : name.toLowerCase();\n\n    if (!(loggerName in Logger.loggers)) {\n      Logger.loggers[loggerName] = new Logger(handlersConfig.loggerName);\n    }\n\n    return Logger.loggers[loggerName];\n  }\n}\n\nexport default Logger;\n","import Logger from 'axon/utils/logger';\n\nconst LOGGER: Object = Logger.getLogger();\n\n/**\n * [sigIntHandler description]\n * @param  {[type]} void [description]\n * @return {[type]}      [description]\n */\nexport default function sigInitHandler(): void {\n  if (LOGGER) {\n    LOGGER.info('Captured ctrl-c');\n  }\n\n  process.exit(0);\n}\n","import Logger from 'axon/utils/logger';\n\nconst LOGGER: Object = Logger.getLogger('error');\n\n/**\n * [uncaughtExceptionHandler description]\n * @param  {[type]} e [description]\n * @return {[type]}   [description]\n */\nexport default function uncaughtExceptionHandler(e: Error): void {\n  if (LOGGER) {\n    LOGGER.error('An unhandled exception occurred. Server is exiting...');\n    LOGGER.error(e);\n  }\n\n  process.exit(1);\n}\n","import Logger from 'axon/utils/logger';\n\nconst LOGGER: Object = Logger.getLogger('error');\n\n/**\n * [unhandledRejectionHandler description]\n * @param  {[type]} e [description]\n * @return {[type]}   [description]\n */\nexport default function unhandledRejectionHandler(e: Error): void {\n  if (LOGGER) {\n    LOGGER.error(`An unhandled promise rejection occurred: ${e}`);\n  }\n}\n","module.exports = require(\"apollo-cache-inmemory\");","module.exports = require(\"apollo-client\");","module.exports = require(\"apollo-link\");","module.exports = require(\"apollo-link-error\");","module.exports = require(\"apollo-link-http\");","module.exports = require(\"bunyan\");","module.exports = require(\"config\");","module.exports = require(\"domain\");","module.exports = require(\"events\");","module.exports = require(\"fs\");","module.exports = require(\"https\");","module.exports = require(\"koa\");","module.exports = require(\"koa-body\");","module.exports = require(\"koa-compress\");","module.exports = require(\"koa-cors\");","module.exports = require(\"koa-helmet\");","module.exports = require(\"koa-morgan\");","module.exports = require(\"koa-mount\");","module.exports = require(\"koa-router\");","module.exports = require(\"koa-static\");","module.exports = require(\"node-fetch\");","module.exports = require(\"process\");","module.exports = require(\"uuid/v4\");"],"sourceRoot":""}