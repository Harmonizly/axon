{"version":3,"sources":["webpack:///webpack/bootstrap b32476f66bd225b24553","webpack:///./index.js","webpack:///./src/api/controllers/health.js","webpack:///./src/api/controllers/meta.js","webpack:///./src/exception/codes.js","webpack:///./src/exception/index.js","webpack:///./src/main.js","webpack:///./src/middleware/error.js","webpack:///./src/middleware/logging.js","webpack:///./src/middleware/transaction.js","webpack:///./src/utils/logger.js","webpack:///external \"babel-polyfill\"","webpack:///external \"body-parser\"","webpack:///external \"bunyan\"","webpack:///external \"compression\"","webpack:///external \"connect-flash-plus\"","webpack:///external \"cors\"","webpack:///external \"domain\"","webpack:///external \"express\"","webpack:///external \"fs\"","webpack:///external \"helmet\"","webpack:///external \"https\"","webpack:///external \"process\"","webpack:///external \"swagger-tools\"","webpack:///external \"uuid/v4\""],"names":["ping","request","response","status","send","describe","doc","FATAL_ERROR","code","category","message","GENERAL_ERROR","extra","NOT_YET_IMPLEMENTED","ILLEGAL_STATE_EXCEPTION","NOT_AUTHORIZED","NOT_ALLOWED","MISSING_REQUIRED_PARAMETER","MODEL_NOT_FOUND","MODEL_NOT_UPDATED","MODEL_NOT_CREATED","VALIDATION_ERROR","DEFAULT_CODE","DEFAULT_MESSAGE","DEFAULT_STATUS","resolveCode","payload","resolveMessage","resolveStatus","Exception","Error","captureStackTrace","constructor","stack","toString","DEFAULT_SWAGGER_OPTS","apiDocs","apiDocsPrefix","controllers","ignoreMissingHandlers","security","swaggerUi","swaggerUiDir","swaggerUiPrefix","useStubs","validateResponse","Server","config","app","configure","boundSigIntHandler","sigIntHandler","bind","on","boundUncaughtExceptionHandler","unhandledExceptionHandler","logger","use","cors","urlencoded","extended","json","unsafe","conf","assets","get","static","destroy","removeEventListeners","initialize","initializeSwagger","options","Promise","resolve","reject","initializeMiddleware","middleware","mergedOpts","swaggerMetadata","swaggerValidator","swaggerSecurity","swaggerRouter","onStart","all","start","callback","cb","info","startHttps","startHttp","error","console","listen","next","secure","redirect","hostname","url","sslConfig","httpsConfig","Object","assign","key","readFileSync","cert","createServer","stop","server","close","port","exit","removeListener","e","errorMiddleware","notFoundError","LOGGER","accessLogger","method","headers","transactionMiddleware","transactionId","transaction","create","add","data","id","run","getLogger","createLoggers","loggers","Logger","debug","args","format","trace","warn","formatInput","formatTransaction","arg1","Array","isArray","JSON","stringify","parse","length","domain","sessionId","session","user","username","name","opts","loggerName","toLowerCase","pending","seen","entries","currName","currConfig","push","pop","parentName","child","component","childName","childConfig","includes"],"mappings":"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","file":"jarvis.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b32476f66bd225b24553","import Exception from 'jarvis/exception';\nimport Server from 'jarvis/main';\nimport * as codes from 'jarvis/exception/codes';\nimport { getLogger } from 'jarvis/utils/logger';\n\nexport default {\n  Server,\n  error: {\n    codes,\n    Exception\n  },\n  logger: {\n    getLogger,\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./index.js\n// module id = ./index.js\n// module chunks = 0","\n/**\n * [ping description]\n * @param  {[type]} request  [description]\n * @param  {[type]} response [description]\n * @return {[type]}          [description]\n */\nexport function ping(request: Object, response: Object): void {\n  return response.status(200).send('pong');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/controllers/health.js","/**\n * [describe description]\n * @param  {[type]} doc [description]\n * @return {[type]}\n */\nexport function describe(doc: Object): Function {\n  return (request: Object, response: Object): void => {\n    return response.send(doc);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/controllers/meta.js","export const FATAL_ERROR: Object = {\n  status: 500,\n  code: 0,\n  category: 'IllegalStateException',\n  message: 'An error occurred. If this error persists, please contact your System Administrator',\n};\n\nexport const GENERAL_ERROR: Function = function (message: string, extra: string = ''): Object {\n  return {\n    status: 400,\n    code: 0,\n    category: 'GeneralException',\n    message,\n    extra,\n  };\n};\n\nexport const NOT_YET_IMPLEMENTED: Object = {\n  status: 501,\n  code: 1,\n  category: 'NotYetImplemented',\n  message: 'This method must be implmented',\n};\n\nexport const ILLEGAL_STATE_EXCEPTION: Object = {\n  status: 500,\n  code: 2,\n  category: 'IllegalStateException',\n  message: 'Application not configured correctly',\n};\n\nexport const NOT_AUTHORIZED: Object = {\n  status: 401,\n  code: 3,\n  category: 'SecurityException',\n  message: 'You are not authorized to access this resource',\n};\n\nexport const NOT_ALLOWED: Object = {\n  status: 403,\n  code: 4,\n  category: 'SecurityException',\n  message: 'You are not authorized to access this resource',\n};\n\nexport const MISSING_REQUIRED_PARAMETER: Object = {\n  status: 400,\n  code: 5,\n  category: 'GeneralException',\n  message: 'A required parameter was missing',\n};\n\nexport const MODEL_NOT_FOUND: Object = {\n  status: 404,\n  code: 100,\n  category: 'NotFoundException',\n  message: 'Requested model could not be found',\n};\n\nexport const MODEL_NOT_UPDATED: Object = {\n  status: 400,\n  code: 200,\n  category: 'TransactionException',\n  message: 'Update failed',\n};\n\nexport const MODEL_NOT_CREATED: Object = {\n  status: 400,\n  code: 201,\n  category: 'TransactionException',\n  message: 'Creation failed',\n};\n\nexport const VALIDATION_ERROR: Function = function (message: string, extra: string = ''): Object {\n  return {\n    status: 400,\n    code: 202,\n    category: 'ValidationException',\n    message,\n    extra,\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/exception/codes.js","const DEFAULT_CODE: number = 0;\nconst DEFAULT_MESSAGE: string = 'An Unknown error occurred';\nconst DEFAULT_STATUS: number = 500;\n\n/**\n * [resolveCode description]\n * @param  {[type]} payload [description]\n * @return {[type]}         [description]\n */\nfunction resolveCode(payload: number | Object): number {\n  if (typeof payload === 'number') {\n    return ('code' in payload) ? DEFAULT_CODE : payload.code;\n  }\n\n  return DEFAULT_CODE;\n}\n\n/**\n * [resolveMessage description]\n * @param  {[type]} payload [description]\n * @return {[type]}         [description]\n */\nfunction resolveMessage(payload: string | Object): string {\n  if (typeof payload === 'object') {\n    return ('message' in payload) ? DEFAULT_MESSAGE : payload.message;\n  }\n\n  return payload;\n}\n\n/**\n * [resolveStatus description]\n * @param  {[type]} payload [description]\n * @param  {[type]} status  [description]\n * @return {[type]}         [description]\n */\nfunction resolveStatus(payload: number | Object, status: ?number): number {\n  if (typeof payload === 'object' && 'status' in payload) {\n    return payload.status;\n  }\n\n  return (status == null) ? DEFAULT_CODE : status;\n}\n\n/**\n * [code description]\n * @type {[type]}\n */\nexport default class Exception extends Error {\n  code: number;\n  status: number;\n\n  /**\n   * [constructor description]\n   * @param  {[type]} payload [description]\n   * @param  {[type]} code    [description]\n   * @param  {[type]} status  [description]\n   * @return {[type]}         [description]\n   */\n  constructor(payload: string | Object = DEFAULT_MESSAGE, status) {\n    super(resolveMessage(payload));\n    this.code = resolveCode(payload);\n    this.status = resolveStatus(payload, status);\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      this.stack = (new Error(message)).stack;\n    }\n  }\n\n  /**\n   *\n   */\n  toString(): string {\n    return `${this.code} - ${this.status} ${this.message}`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/exception/index.js","import bodyParser from 'body-parser';\nimport compression from 'compression';\nimport cors from 'cors';\nimport express from 'express';\nimport flash from 'connect-flash-plus';\nimport fs from 'fs';\nimport helmet from 'helmet';\nimport https from 'https';\nimport process from 'process';\nimport swaggerTools from 'swagger-tools';\n\nimport { accessLogger } from 'jarvis/middleware/logging';\nimport { describe } from 'jarvis/api/controllers/meta';\nimport { errorMiddleware, notFoundError } from 'jarvis/middleware/error';\nimport { getLogger, createLoggers } from 'jarvis/utils/logger';\nimport { ping } from 'jarvis/api/controllers/health';\nimport { transactionMiddleware } from 'jarvis/middleware/transaction';\n\nconst DEFAULT_SWAGGER_OPTS: Object = {\n  apiDocs: '/api-docs',\n  apiDocsPrefix: '',\n  controllers: {},\n  ignoreMissingHandlers: false,\n  security: {},\n  swaggerUi: '/docs',\n  swaggerUiDir: '',\n  swaggerUiPrefix: '',\n  useStubs: false,\n  validateResponse: true,\n};\n\n/**\n * [app description]\n * @type {[type]}\n */\nexport default class Server {\n  app: Function;\n  config: Object;\n  logger: Object;\n\n  /**\n   * [constructor description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  constructor(config: Object): void {\n    this.config = { ...config };\n\n    // Initialize the express server\n    this.app = express();\n\n    // Create all the loggers\n    createLoggers(config);\n\n    // Configure the app with common middleware\n    this.configure(this.app);\n\n    // Catches ctrl+c event\n    this.boundSigIntHandler = this.sigIntHandler.bind(this);\n    process.on('SIGINT', this.boundSigIntHandler);\n\n    // Catches uncaught exceptions and rejections\n    this.boundUncaughtExceptionHandler = this.unhandledExceptionHandler.bind(this);\n    process.on('uncaughtException', this.boundUncaughtExceptionHandler);\n    process.on('unhandledRejection', this.boundUncaughtExceptionHandler);\n  }\n\n  /**\n   * [app description]\n   * @type {[type]}\n   */\n  configure(app: Object): void {\n\n    // Attach the logger (also create since this is the first access)\n    this.logger = getLogger('root');\n\n    // Add common request security measures\n    app.use(helmet());\n\n    // Enabled CORS (corss-origin resource sharing)\n    app.use(cors(config.cors));\n\n    // request compression\n    app.use(compression());\n\n    // Initialize body parser before routes or body will be undefined\n    app.use(bodyParser.urlencoded({ extended: true }));\n    app.use(bodyParser.json());\n\n    // Setup flash messaging\n    app.use(flash({ unsafe: true }));\n\n    // Trace a single request process (including over async)\n    app.use(transactionMiddleware);\n\n    // Configure Request logging\n    // TODO switch to morgan\n    app.use(accessLogger);\n\n    // Serve asset resources using the 'assets' url\n    app.use(\n      conf.assets.get('url'),\n      express.static(conf.assets.get('path')),\n    );\n\n    // Serve static resources using the 'static' url\n    app.use(\n      conf.static.get('url'),\n      express.static(conf.static.get('path')),\n    );\n\n    // Configure the request error handling\n    // TODO more specific error handling - make this one a fallback handler?\n    app.use(errorMiddleware);\n  }\n\n  /**\n   * [destroy description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  destroy(): void {\n    this.removeEventListeners();\n    // TODO logger destroy\n    // TODO send destroy event?\n  }\n\n  /**\n   * Attach middleware & controllers to the Express app.\n   * Note: Order matters here.\n   * @param  {[type]}  void [description]\n   * @return {Promise}      [description]\n   */\n  async initialize(app: Object, conf: Object): void {\n    throw new Error('initialize must be implemented');\n  }\n\n  /**\n   * Initializes the Swagger middleware with the given swagger document and options.\n   * Applies the following middleware:\n   * - <code>metadata</code>\n   * - <code>validator</code>\n   * - <code>security</code>\n   * - <code>router</code>\n   * - <code>ui</code>\n   *\n   * Reference: https://github.com/apigee-127/swagger-tools/blob/master/docs/Middleware.md\n   *\n   * Options\n   * =======\n   * validateResponse       [boolean=false]           Whether or not to validate responses\n   * apiDocs                [string=/api-docs]        The path to serve the Swagger documents from\n   * apiDocsPrefix          [string=]                 The prefix to prepend to the options.apiDocs (This is required\n   *                                                  when serving a swagger-tools based API behind a reverse proxy.)\n   * swaggerUi              [string=/docs]            The path to serve Swagger UI from\n   * swaggerUiDir           [string]                  The filesystem path to your custom swagger-ui deployment to serve\n   * swaggerUiPrefix        [string]                  The prefix to prepend to the options.swaggerUi (This is required\n   *                                                  when serving a swagger-tools UI behind a reverse proxy.)\n   * security               [object]                  An object containing the authorization/security name, the value is\n   *                                                  a function that will be used to perform the authentication/\n   *                                                  authorization. The function signature for the callback is:\n   *                                                  function (req, authOrSecDef, scopesOrApiKey, callback).\n   * controllers            [string|string[]|object]  The controllers to look for or use. If the value is a string, we\n   *                                                  assume the value is a path to a directory that contain controller\n   *                                                  modules. If the value is an array, we assume the value is an array\n   *                                                  of paths to directories that contain controller modules. If the\n   *                                                  value is an object, we assume the object keys are the handler name\n   *                                                  ({ControllerName}{HandlerFunctionName}) and the value is a\n   *                                                  function.\n   * ignoreMissingHandlers: [boolean]                 When false (default), a 500 is returned when a handler cannot be\n   *                                                  found. When true, we will ignore the missing handler and send the\n   *                                                  request downstream.\n   * useStubs:              [boolean]                 Whether or not stub handlers should be used for routes with no\n   *                                                  defined controller or the controller could not be found.\n   *\n   * @param  {[type]} options [description]\n   * @return {[type]}         [description]\n   */\n  initializeSwagger(doc: Object, options: Object): Promise<void> {\n    return new Promise((resolve: Function, reject: Function): void => {\n      swaggerTools.initializeMiddleware(doc, (middleware: ?Object) => {\n        if (!middleware) {\n          reject(new Error('Failed to initialize swagger'));\n        }\n\n        const mergedOpts: Object = {\n          ...DEFAULT_SWAGGER_OPTS,\n          options\n        }\n\n        // Interpret Swagger resources and attach metadata to request\n        this.app.use(middleware.swaggerMetadata());\n\n        // Validate Swagger requests\n        this.app.use(middleware.swaggerValidator({\n          validateResponse: mergedOpts.validateResponse,\n        }));\n\n        // Authenticate/authorize requests based on the authorization/security definitions\n        this.app.use(middleware.swaggerSecurity(mergedOpts.security));\n\n        // Route validated requests to appropriate controller\n        app.use(middleware.swaggerRouter({\n          controllers: {\n            ...mergedOpts.controllers,\n            describe: describe(doc),\n            ping,\n          },\n          ignoreMissingHandlers: mergedOpts.ignoreMissingHandlers,\n          useStubs: mergedOpts.useStubs,\n        }));\n\n        // Serve the Swagger documents and Swagger UI\n        app.use(middleware.swaggerUi({\n          apiDocs: mergedOpts.apiDocs,\n          apiDocsPrefix: mergedOpts.apiDocsPrefix,\n          swaggerUi: mergedOpts.swaggerUi,\n          swaggerUiDir: mergedOpts.swaggerUiDir,\n          swaggerUiPrefix: mergedOpts.swaggerUiPrefix,\n        }));\n\n        resolve();\n      });\n    });\n  }\n\n  /**\n   * [onStart description]\n   * @param  {[type]} Promise [description]\n   * @return {[type]}         [description]\n   */\n  async onStart(): Promise<void> {\n    // Call the abstract initialize method to allow for custom setup\n    await this.initialize(this.app, this.config);\n\n    // Send 404 if we get here in the route processing\n    app.all('*', notFoundError);\n  }\n\n  /**\n   * [callback description]\n   * @type {Function}\n   */\n  async start(callback: Function | null = null): void {\n    if (!this.app) {\n      throw new Error('Cannot start server: the express instance is not defined');\n    }\n\n    const cb: Function = () => {\n      if (callback != null) {\n        callback();\n      }\n      // process.send('ready');\n      this.logger.info(`Server listening at ${this.config.get('hostname')}:${this.config.get('port')}...`);\n    };\n\n    try {\n      // Call the abstract initialize method to allow for custom setup\n      await this.onStart();\n\n      return (this.config.get('secure')) ? this.startHttps(cb) : this.startHttp(cb);\n    } catch (e) {\n      if (this.logger) {\n        this.logger.error(e);\n      } else {\n        /* eslint-disable no-console */\n        console.error(e);\n      }\n      this.destroy();\n      throw e;\n    }\n  }\n\n  /**\n   * [startHttp description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  startHttp(callback: Function): void {\n    return this.app.listen(\n      this.config.get('port'),\n      this.config.get('hostname'),\n      this.config.get('backlog'),\n      callback,\n    );\n  }\n\n  /**\n   * [startHttps description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  startHttps(callback: Function): void {\n    this.app.all('*', function cb(request: Object, response: Object, next: Function) {\n      if (request.secure) {\n        return next();\n      }\n\n      return response.redirect(`https://${request.hostname}:${this.config.get('port')}${request.url}`);\n    });\n\n    const sslConfig = this.config.get('ssl');\n    const httpsConfig = Object.assign({}, sslConfig, {\n      key: fs.readFileSync(sslConfig.get('key')),\n      cert: fs.readFileSync(sslConfig.get('cert')),\n    });\n\n    return https.createServer(httpsConfig, this.app).listen(\n      this.config.get('port'),\n      this.config.get('hostname'),\n      this.config.get('backlog'),\n      callback,\n    );\n  }\n\n  /**\n   * [stop description]\n   * @param  {Function} callback [description]\n   * @return {[type]}            [description]\n   */\n  stop(callback: Function | null = null): void {\n    if (this.app && this.app.server) {\n      this.app.server.close(() => {\n        if (callback != null && typeof callback === 'function') {\n          callback();\n        }\n        this.logger.info(`Server (${this.config.hostname}:${this.config.port}) stopping...`);\n      });\n    }\n    this.destroy();\n  }\n\n  /**\n   * [sigIntHandler description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  sigIntHandler(): void {\n    if (this.logger) {\n      this.logger.info('Captured ctrl-c');\n    }\n\n    this.stop();\n    process.exit(0);\n  }\n\n  /**\n   * [removeEventListeners description]\n   * @param  {[type]} void [description]\n   * @return {[type]}      [description]\n   */\n  removeEventListeners(): void {\n    process.removeListener('SIGINT', this.boundSigIntHandler);\n    process.removeListener('uncaughtException', this.boundUncaughtExceptionHandler);\n  }\n\n  /**\n   * [unhandledExceptionHandler description]\n   * @param  {[type]} e [description]\n   * @return {[type]}   [description]\n   */\n  unhandledExceptionHandler(e: Error): void {\n    if (this.logger) {\n      this.logger.error('An unhandled exception occurred. Reporting then terminating process');\n      this.logger.error(e);\n    }\n\n    this.stop();\n    process.exit(1);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import { getLogger } from 'jarvis/utils/logger';\n\nconst LOGGER: Object = getLogger('root');\n\n/**\n * [errorParser description]\n * @param  {[type]}   error    [description]\n * @param  {[type]}   request  [description]\n * @param  {[type]}   response [description]\n * @param  {Function} next     [description]\n * @return {[type]}            [description]\n */\nexport function errorMiddleware(error: any, request: Object, response: Object, next: Function): void {\n  const e: Object = { ...error };\n\n  if (!('status' in e)) {\n    e.status = 500;\n  }\n\n  if (!('code' in e)) {\n    e.code = -1;\n  }\n\n  LOGGER.error(e);\n  response.status(e.code).send(e);\n}\n\n/**\n * [notFoundError description]\n * @param  {[type]}   request  [description]\n * @param  {[type]}   response [description]\n * @param  {Function} next     [description]\n * @return {[type]}            [description]\n */\nexport function notFoundError(request: Object, response: Object): void {\n  response.status(404).send();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/error.js","import { getLogger } from 'jarvis/utils/logger';\n\nconst LOGGER: Object = getLogger('request');\n\n/**\n * TODO use morgan\n */\nexport function accessLogger(request: Object, response: Object, next: Function): void {\n  LOGGER.info({\n    method: request.method,\n    url: request.url,\n    headers: request.headers,\n  });\n  next();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/logging.js","import domain from 'domain';\nimport uuidv4 from 'uuid/v4';\n\n/**\n * Add a transaction identifier to every request to track a request's control flow. We use a transactoin ID instead of\n * the session ID or user since both are persistent(ish) identification.\n *\n * @param  {[type]}   request  [description]\n * @param  {[type]}   response [description]\n * @param  {Function} next     [description]\n * @return {[type]}            [description]\n */\nexport function transactionMiddleware(request: Object, response: Object, next: Function): void {\n  const transactionId: string = uuidv4();\n  const transaction: Object = domain.create();\n\n  // eslint-disable-next-line no-param-reassign\n  request.transactionId = transactionId;\n\n  transaction.add(request);\n  transaction.add(response);\n  transaction.data = {\n    id: transactionId,\n    request,\n    response,\n  };\n\n  transaction.run(next);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/transaction.js","import Bunyan from 'bunyan';\nimport process from 'process';\n\nconst DEFAULT_CODE: number = 0;\nconst DEFAULT_MESSAGE: string = 'This is not the message you are looking for';\nconst DEFAULT_STATUS: number = 500;\n\nconst loggers: Object = {};\n\n/**\n *\n */\nclass Logger extends Bunyan {\n\n  /**\n   * [debug description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  debug(...args) {\n    return super.debug(this.format(args));\n  }\n\n  /**\n   * [error description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  error(...args) {\n    return super.error(this.format(args));\n  }\n\n  /**\n   * [info description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  info(...args) {\n    return super.info(this.format(args));\n  }\n\n  /**\n   * [trace description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  trace(...args) {\n    return super.trace(this.format(args));\n  }\n\n  /**\n   * [warn description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  warn(...args) {\n    return super.warn(this.format(args));\n  }\n\n  /**\n   * [format description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  format(args: Array<any>): Object {\n    return {\n      ...formatInput(args),\n      ...formatTransaction(),\n    };\n  }\n\n  /**\n   * [formatInput description]\n   * @param  {[type]} args [description]\n   * @return {[type]}      [description]\n   */\n  formatInput(args): Object {\n    let payload: Object = {};\n\n    // Arrays shouldn't exist, but in the\n    // off-chance they do, turn it into a string\n    const arg1: any = Array.isArray(args[0]) ? JSON.stringify(args[0]) : args[0];\n\n    switch (typeof arg1) {\n      case 'object':\n        payload = {\n          code: DEFAULT_CODE,\n          status: DEFAULT_STATUS,\n          ...arg1,\n        };\n        break;\n      default:\n\n        // Attempt to convert the parameter to JSON object,\n        // falling back to just applying it to the message attribute\n        try {\n          payload.message = JSON.parse(arg1);\n        } catch (e) {\n          payload.message = arg1;\n        }\n\n        payload.status = args.length > 1 ? args[1] : DEFAULT_STATUS;\n        payload.code = args.length > 2 ? args[2] : DEFAULT_CODE;\n        break;\n    }\n\n    return payload;\n  }\n\n  /**\n   * [formatTransaction description]\n   * @param  {[type]} Object [description]\n   * @return {[type]}        [description]\n   */\n  formatTransaction(): Object {\n    const payload: Object = {};\n    const transaction: Object = process.domain;\n\n    if (transaction && transaction.data) {\n      const { request } = transaction.data;\n\n      payload.sessionId = request.session && request.session.id;\n      payload.transactionId = transaction.data.id;\n\n      if (request.user) {\n        payload.user = {\n          id: request.user.id,\n          username: request.user.username,\n        };\n      }\n    }\n\n    return payload;\n  }\n}\n\n\n/**\n * [getLogger description]\n * @param  {[type]} name [description]\n * @return {[type]}      [description]\n */\nexport function getLogger(name: string, opts: ?Object): Object {\n  const loggerName = (name == null) ? 'app' : name.toLowerCase();\n\n  return loggers[loggerName];\n}\n\n/**\n * [createLogger description]\n * @param  {[type]} config [description]\n * @return {[type]}        [description]\n */\nexport function createLoggers(config: Object): Object {\n  // breadth-first search of opts\n  // if name is under another logger, then is child. get parent logger and create child on it\n\n  const pending = [];\n  const seen = [];\n\n  for (const [ currName, currConfig] of config.entries()) {\n    pending.push([currName, currConfig]);\n    seen.push(currName);\n  }\n\n  while (!pending.length) {\n    const [currName, currConfig, parentName] = pending.pop();\n\n    if (parentName != null) {\n      loggers[currName] = loggers[parentName].child({\n        component: currName,\n        ...currConfig,\n      });\n    } else {\n      loggers[currName] = new Logger(currConfig);\n    }\n\n    for (const [childName, childConfig] of currConfig.entries()) {\n      if (!seen.includes(childName)) {\n        pending.push([childName, childConfig, currName]);\n        seen.push(childName);\n      }\n    }\n  }\n}\n\n/*\n * BEGIN NOTE: example of stream config\n  streamConfig = Object.assign({}, streamsConfig.get('cloudwatch'));\n  streamConfig.logStreamName += `-${process.pid}-${uuidv4()}`;\n  logger.addStream({\n    name: 'cloudwatch',\n    type: 'raw',\n    stream: createCWStream(Object.assign({}, streamConfig)),\n  });\n * END NOTE\n */\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/logger.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = babel-polyfill\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = body-parser\n// module chunks = 0","module.exports = require(\"bunyan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bunyan\"\n// module id = bunyan\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = compression\n// module chunks = 0","module.exports = require(\"connect-flash-plus\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash-plus\"\n// module id = connect-flash-plus\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = cors\n// module chunks = 0","module.exports = require(\"domain\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"domain\"\n// module id = domain\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = express\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = fs\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = helmet\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = https\n// module chunks = 0","module.exports = require(\"process\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"process\"\n// module id = process\n// module chunks = 0","module.exports = require(\"swagger-tools\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"swagger-tools\"\n// module id = swagger-tools\n// module chunks = 0","module.exports = require(\"uuid/v4\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid/v4\"\n// module id = uuid/v4\n// module chunks = 0"],"sourceRoot":""}